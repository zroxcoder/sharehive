<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>ShareHive - Video Links</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      font-family: Arial, sans-serif;
      background-color: var(--bg-color);
      color: var(--text-color);
      transition: 0.3s;
    }
    :root {
      --bg-color: #ffffff;
      --text-color: #222;
      --primary-color: #0077ff;
      --sidebar-bg: #f4f4f4;
      --card-bg: #f8f8f8;
    }
    body.dark {
      --bg-color: #1e1e1e;
      --text-color: #f0f0f0;
      --sidebar-bg: #2c2c2c;
      --card-bg: #333333;
    }

    .navbar {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 10px 20px;
      background: var(--primary-color);
      color: white;
    }
    .navbar h1 { font-size: 20px; }
    .toggle-btn {
      background: white;
      border: none;
      color: var(--primary-color);
      padding: 5px 10px;
      border-radius: 5px;
      cursor: pointer;
      font-weight: bold;
    }

    .container { display: flex; height: calc(100vh - 50px); }

    .sidebar {
      width: 220px;
      background: var(--sidebar-bg);
      padding: 20px;
      overflow-y: auto;
    }
    .sidebar h2 { font-size: 16px; margin-bottom: 10px; }
    .sidebar a {
      display: block;
      text-decoration: none;
      color: var(--text-color);
      padding: 8px 10px;
      border-radius: 5px;
      margin-bottom: 5px;
    }
    .sidebar a:hover { background: var(--primary-color); color: white; }

    .main { flex: 1; padding: 20px; overflow-y: auto; }
    h2 { margin: 15px 0; }

    .form { margin-bottom: 20px; display: flex; flex-direction: column; gap: 8px; }
    .form input {
      padding: 8px; font-size: 14px;
      border: 1px solid #ccc; border-radius: 5px;
      background: var(--card-bg); color: var(--text-color);
    }
    .form button {
      padding: 8px; border: none;
      background: var(--primary-color); color: white;
      border-radius: 5px; cursor: pointer; font-weight: bold;
    }

    .videos-container {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
      gap: 15px;
    }
    .video {
      background: var(--card-bg);
      padding: 15px; 
      border-radius: 10px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
      overflow: hidden; /* Add this */
    }
    .video h3 { margin-bottom: 8px; font-size: 16px; }
    .video a {
      color: var(--primary-color);
      text-decoration: none;
      word-break: break-all;
      overflow-wrap: anywhere;
      display: block;
      max-width: 100%;
      white-space: normal;
    }
    .actions { display: flex; gap: 8px; margin-top: 10px; }
    .video button {
      border: none; padding: 5px 8px;
      border-radius: 5px; cursor: pointer; font-size: 12px;
    }
    .edit { background: #4caf50; color: white; }
    .delete { background: #f44336; color: white; }
  </style>
</head>
<body>
  <!-- Navbar -->
  <div class="navbar">
    <h1>ğŸ ShareHive - Video Links</h1>
    <button class="toggle-btn" onclick="toggleTheme()">ğŸŒ™</button>
  </div>

  <div class="container">
    <!-- Sidebar -->
    <div class="sidebar">
      <h2>Menu</h2>
      <a href="index.html">ğŸ  Dashboard</a>
      <a href="notes.html">ğŸ“ Notes</a>
      <a href="bookmarks.html">ğŸ”– Bookmarks</a>
      <a href="videos.html">ğŸ¬ Video Links</a>
      <a href="todo.html">âœ… To-Do List</a>
      <a href="expense.html">ğŸ’° Expense Tracker</a>
      <a href="planner.html">ğŸ“… Planner</a>
      <a href="wiki.html">ğŸ“– Wiki</a>
      <a href="uploads.html">ğŸ“‚ Upload Files</a>
      <a href="projects.html">ğŸ“Œ Projects</a>
      <a href="watchlist.html">ğŸ¥ Watchlist</a>
      <a href="courses.html">ğŸ“š Courses</a>
      <a href="profile.html">ğŸ‘¤ Profile</a>
      <a href="settings.html">âš™ï¸ Settings</a>
      <hr>
      <a href="about.html">â„¹ï¸ About</a>
      <a href="help.html">â“ Help</a>
      <a href="faq.html">â” FAQ</a>
      <a href="blog.html">ğŸ“° Blog</a>
      <a href="contact.html">âœ‰ï¸ Contact</a>
      <a href="join.html">ğŸ¤ Join Us</a>
      <a href="report.html">ğŸ Report</a>
      <a href="privacy.html">ğŸ“œ Privacy & Policy</a>
      <a href="community.html">ğŸŒ Community</a>
    </div>

    <!-- Main -->
    <div class="main">
      <div class="form">
        <input id="title" type="text" placeholder="Video Title">
        <input id="url" type="url" placeholder="Video URL">
        <button id="saveBtn">Save Video</button>
      </div>
      <div class="search-box">
        <input id="search" type="text" placeholder="Search videos...">
      </div>
      <div class="videos-container"></div>
    </div>
  </div>

  <script>
    // Dark Mode
    function toggleTheme() {
      document.body.classList.toggle("dark");
      localStorage.setItem("theme", document.body.classList.contains("dark") ? "dark" : "light");
    }
    if(localStorage.getItem("theme") === "dark") document.body.classList.add("dark");

// ğŸ“¦ IndexedDB (v21 unified)
let db;
const stores = [
  "notes",
  "bookmarks",
  "videos",
  "todos",
  "expenses",
  "planner",
  "wiki",
  "uploads",
  "projects",
  "watchlist",
  "courses",
  "profile",
  "settings",
  "community"
];

const request = indexedDB.open("ShareHiveDB", 21);

request.onupgradeneeded = e => {
  db = e.target.result;
  stores.forEach(name => {
    if (!db.objectStoreNames.contains(name)) {
      db.createObjectStore(name, { keyPath: "id", autoIncrement: true });
    }
  });
};

request.onsuccess = e => { 
  db = e.target.result; 
  displayVideos();  // âœ… call page-specific display function
};

request.onerror = e => console.error("DB error:", e.target.error);




    // Save / Update
    document.getElementById("saveBtn").onclick = () => {
      const title = document.getElementById("title").value.trim();
      const url = document.getElementById("url")?.value.trim();
      const content = document.getElementById("content")?.value.trim();
      if (!title || (!url && typeof url !== "undefined") && (!content && typeof content !== "undefined")) return;

      const btn = document.getElementById("saveBtn");
      const editId = btn.getAttribute("data-edit");

      const tx = db.transaction("videos", "readwrite"); // change to "notes" or "bookmarks" as needed
      const store = tx.objectStore("videos"); // change to "notes" or "bookmarks" as needed

      if (editId) {
        store.put({ id: Number(editId), title, url, content });
        btn.removeAttribute("data-edit");
      } else {
        store.add({ title, url, content });
      }

      tx.oncomplete = () => {
        document.getElementById("title").value = "";
        if (document.getElementById("url")) document.getElementById("url").value = "";
        if (document.getElementById("content")) document.getElementById("content").value = "";
        displayVideos(); // or displayNotes(), displayBookmarks()
      };
    };

    // Display
    function displayVideos() {
      const tx = db.transaction("videos", "readonly");
      const req = tx.objectStore("videos").getAll();

      req.onsuccess = () => {
        let videos = req.result;

        // Search filter
        const search = document.getElementById("search").value.toLowerCase();
        if (search) {
          videos = videos.filter(v => v.title.toLowerCase().includes(search) || v.url.toLowerCase().includes(search));
        }

        const container = document.querySelector(".videos-container"); // <-- FIXED
        container.innerHTML = "";
        videos.forEach(v => {
          const div = document.createElement("div");
          div.className = "video";
          div.innerHTML = `
            <h3>${v.title}</h3>
            <a href="${v.url}" target="_blank">${v.url}</a>
            <div class="actions">
              <button class="edit" onclick="editVideo(${v.id})">Edit</button>
              <button class="delete" onclick="deleteVideo(${v.id})">Delete</button>
            </div>`;
          container.appendChild(div);
        });
      };
    }

    // Edit
    function editVideo(id) {
      const tx = db.transaction("videos", "readonly");
      const req = tx.objectStore("videos").get(id);

      req.onsuccess = () => {
        const v = req.result;
        document.getElementById("title").value = v.title;
        document.getElementById("url").value = v.url;
        const btn = document.getElementById("saveBtn");
        btn.textContent = "Update Video";
        btn.setAttribute("data-edit", id);
      };
    }

    // Delete
    function deleteVideo(id) {
      const tx = db.transaction("videos", "readwrite");
      tx.objectStore("videos").delete(id);
      tx.oncomplete = displayVideos;
    }

    // Live search
    document.getElementById("search").addEventListener("input", displayVideos);
  </script>
</body>
</html>
